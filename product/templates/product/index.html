<!DOCTYPE html>
<html lang="en">

<head>

    <title>E-Commerce Site</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Django tags to load static files and humanize library -->
    {% load static %}
    {% load humanize %}
    <!-- Bootstrap script -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- FontAwesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="{% static 'css/stylesheet.css' %}" rel="stylesheet">
</head>

<body>
    <!-- Main navigation bar of the site -->
    <nav class="navbar navbar-expand-sm navbar-light bg-light">
        <div class="container-fluid">
            <!-- Navbar logo -->
            <div class="navbar-header">
                <img class="navbar-brand" src="{% static 'assets/logo_sm.png' %}">
            </div>

            <!-- Toggle button for mobile view (collapsed navbar) -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mynavbar">
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- Navbar links (Shop, Great Deals, About) -->
            <div class="collapse navbar-collapse" id="mynavbar">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="javascript:void(0)">Shop</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="javascript:void(0)">Great Deals</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="javascript:void(0)">About</a>
                    </li>

                </ul>
            </div>
        </div>
    </nav>

    <!-- Search and Filter Form Section -->
    <div class="col py-4 px-5">
        <h3>Search & Filter</h3>
        <div class="row justify-content-center">
            <form action="" class="d-flex search-container" method="get">
                <div class="input-group">
                    <input class="form-control flex-1 searchbar" type="text" name="search" placeholder="Search">
                    <input type="hidden" name="filter" value="{{selected_cat}}">
                    <button type="submit"><i class="fa fa-search"></i></button>
                </div>
            </form>
            <div class="btn-group flex-wrap btn-group-sm">
                <a href="?" class="btn btn-primary">All</a>

                <!-- Loop over available categories to generate radio buttons for each -->
                {% for category in categories %}
                {% if selected_cat == category.id %}
                <a class="btn btn-primary active" href="javascript:void(0)">
                    {{category.name}}
                </a>
                {% else %}
                <a class="btn btn-primary" href="?filter={{ category.id }}">
                    {{category.name}}
                </a>
                {% endif %}
                {% endfor %}

            </div>
        </div>
    </div>

    <!-- Product Listing Section -->
    <div class="row justify-content-center align-items-stretch">
        {% if page_obj %}
        <!-- Loop through products in the current page -->
        {% for product in page_obj %}
        <div class="card card-custom m-2 col-xl-2 col-lg-3 col-sm-4 col-10">
            <img class="card-img-top" src="{{ product.image }}" alt="Product Image">
            <div class="card-body">
                <h4 class="card-title text-break">{{ product.name }}</h4>
                <p class="card-text">{{ product.description|truncatewords:10 }}</p>
                <h6 class="card-text text-end">${{ product.price|intcomma }}</h6>
            </div>
        </div>
        {% endfor %}
        {% else %}
        <p class="text-center">No results</p>
        {% endif %}

    </div>

    <!-- Pagination Section -->
    <div class="d-flex flex-row-reverse p-5">
        <ul class="pagination">
            <!-- Previous page link (disabled if on the first page) -->
            {% if page_obj.has_previous %}
            <li class="page-item"><a class="page-link" href="?filter={{ selected_cat }}&page=1">&laquo;</a></li>
            <li class="page-item"><a class="page-link"
                    href="?filter={{ selected_cat }}&page={{ page_obj.previous_page_number }}">Previous</a>
            </li>
            {% else %}
            <li class="page-item disabled"><a class="page-link" href="#">&laquo;</a></li>
            <li class="page-item disabled"><a class="page-link" href="#">Previous</a></li>
            {% endif %}
            <!-- Current page number -->
            <li class="page-item">
                <span class="page-link text-secondary">Page {{ page_obj.number }} of
                    {{page_obj.paginator.num_pages}}</span>
            </li>
            <!-- Next page link (disabled if on the last page) -->
            {% if page_obj.has_next %}
            <li class="page-item"><a class="page-link"
                    href="?filter={{ selected_cat }}&page={{ page_obj.next_page_number }}">Next</a></li>
            <li class="page-item"><a class="page-link"
                    href="?filter={{ selected_cat }}&page={{ page_obj.paginator.num_pages }}">&raquo;</a></li>
            {% else %}
            <li class="page-item disabled"><a class="page-link" href="#">Next</a></li>
            <li class="page-item disabled"><a class="page-link" href="#">&raquo;</a></li>
            {% endif %}
        </ul>
    </div>
</body>
</div>

</html>